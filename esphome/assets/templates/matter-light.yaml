# Generated by esphome@aurora-smart-home v1.0.0
# https://github.com/tonylofgren/aurora-smart-home
#
# Matter Light Template
# ---------------------
# ESP32-C6 based Matter-compatible smart light.
# Works with Apple Home, Google Home, Amazon Alexa via Matter.
#
# Hardware Requirements:
#   - ESP32-C6 (recommended for Matter + Thread support)
#   - Or: ESP32, ESP32-S3, ESP32-C3 (WiFi-only Matter)
#   - LED/Light output (GPIO or PWM)
#
# Supported Platforms:
#   - Apple Home (iOS 16.1+)
#   - Google Home
#   - Amazon Alexa
#   - Samsung SmartThings
#
# Setup:
#   1. Flash this firmware
#   2. Scan QR code from logs with your smart home app
#   3. Device appears in all Matter-compatible apps

substitutions:
  device_name: "matter-light"
  friendly_name: "Matter Light"
  # Light output pin
  light_pin: "GPIO8"
  # Device type: light, dimmable_light, color_temperature_light, extended_color_light
  matter_device_type: "dimmable_light"

esphome:
  name: ${device_name}
  friendly_name: ${friendly_name}
  platformio_options:
    board_build.flash_mode: dio

esp32:
  board: esp32-c6-devkitc-1
  flash_size: 4MB
  framework:
    type: esp-idf
    version: "5.1.2"
    sdkconfig_options:
      CONFIG_ENABLE_MATTER: y
      # Uncomment for Thread support
      # CONFIG_OPENTHREAD_ENABLED: y

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  power_save_mode: none
  # Static IP recommended for Matter stability
  # manual_ip:
  #   static_ip: 192.168.1.100
  #   gateway: 192.168.1.1
  #   subnet: 255.255.255.0

  ap:
    ssid: "${device_name}-fallback"

# Matter configuration
matter:
  device_type: ${matter_device_type}
  # Optional: Custom pairing credentials
  # discriminator: 3840
  # passcode: 20202021

api:
  encryption:
    key: !secret api_encryption_key

ota:
  - platform: esphome
    password: !secret ota_password

logger:
  level: INFO

# =============================================================================
# Light Output Configuration
# =============================================================================

# Option 1: Simple On/Off Light (device_type: light)
# Uncomment this section for basic on/off control
#
# switch:
#   - platform: gpio
#     pin: ${light_pin}
#     name: "Light"
#     id: light_switch

# Option 2: Dimmable Light (device_type: dimmable_light)
# Default configuration - PWM dimming
output:
  - platform: ledc
    pin: ${light_pin}
    id: light_output
    frequency: 1000Hz

light:
  - platform: monochromatic
    name: "Light"
    id: main_light
    output: light_output
    gamma_correct: 2.8
    default_transition_length: 500ms

# Option 3: Color Temperature Light (device_type: color_temperature_light)
# Uncomment and adjust for CCT lights
#
# output:
#   - platform: ledc
#     pin: GPIO8
#     id: warm_output
#   - platform: ledc
#     pin: GPIO9
#     id: cold_output
#
# light:
#   - platform: cwww
#     name: "Light"
#     cold_white: cold_output
#     warm_white: warm_output
#     cold_white_color_temperature: 6500 K
#     warm_white_color_temperature: 2700 K
#     constant_brightness: true

# Option 4: RGB Light (device_type: extended_color_light)
# Uncomment for full RGB control
#
# output:
#   - platform: ledc
#     pin: GPIO4
#     id: red_output
#   - platform: ledc
#     pin: GPIO5
#     id: green_output
#   - platform: ledc
#     pin: GPIO6
#     id: blue_output
#
# light:
#   - platform: rgb
#     name: "Light"
#     red: red_output
#     green: green_output
#     blue: blue_output

# =============================================================================
# Status LED (Optional - for pairing indication)
# =============================================================================

# Uncomment if you have a status LED
# status_led:
#   pin:
#     number: GPIO2
#     inverted: false

# =============================================================================
# Physical Button (Optional)
# =============================================================================

binary_sensor:
  - platform: gpio
    pin:
      number: GPIO9
      mode: INPUT_PULLUP
      inverted: true
    name: "Button"
    on_press:
      - light.toggle: main_light

  - platform: status
    name: "Status"

# =============================================================================
# Diagnostic Sensors
# =============================================================================

sensor:
  - platform: wifi_signal
    name: "WiFi Signal"
    update_interval: 60s
    entity_category: diagnostic

  - platform: uptime
    name: "Uptime"
    entity_category: diagnostic

text_sensor:
  - platform: version
    name: "ESPHome Version"
    entity_category: diagnostic

  - platform: wifi_info
    ip_address:
      name: "IP Address"
      entity_category: diagnostic

button:
  - platform: restart
    name: "Restart"
    entity_category: config

  - platform: factory_reset
    name: "Factory Reset"
    entity_category: config
    disabled_by_default: true
